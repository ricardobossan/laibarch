#!/bin/bash
# YouTube search and play in mpv

if [ -z "$1" ]; then
    echo "Usage: yts <search query>"
    exit 1
fi

# Search YouTube (takes ~20 seconds, be patient)
echo "Searching YouTube for '$*'... (this takes ~20 seconds)" >&2

yt-dlp "ytsearch10:$*" \
    --get-title --get-id --no-playlist \
    --extractor-args "youtube:player_client=default" \
    --flat-playlist 2>/dev/null | \
    paste - - | \
    fzf --prompt="Select video: " --height=50% --reverse | \
    awk '{print $NF}' | \
    xargs -I {} mpv "https://youtube.com/watch?v={}"
